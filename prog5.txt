import java.sql.*;
import java.awt.Dimension;
import java.awt.GridLayout;
import java.awt.event.*;
import javax.swing.*;


public class Representative extends JFrame implements ActionListener{
	JTextField repno,repname,state,comm,rate,cust_no,cust_name,cred,repno1,repname1,state1,comm1,rate1;
	JButton submit,display;
	JTextArea area;
	ResultSet rs;
	Connection con;
	PreparedStatement ps,ps1;
	Statement st;
	
	Representative(){ 
		super("Enter details");
		JLabel r=new JLabel("Enter repno");
		JLabel r1=new JLabel("Enter repname");
		JLabel r2=new JLabel("Enter state");
		JLabel r3=new JLabel("Enter comm");
		JLabel r4=new JLabel("Enter rate");
		JLabel r5=new JLabel("Enter cust_no");
		JLabel r6=new JLabel("Enter cust_name");
		JLabel r7=new JLabel("Enter credit");
		
		repno=new JTextField(20);
		repname=new JTextField(20);
		state=new JTextField(20);
		comm=new JTextField(20);
		rate=new JTextField(20);
		cust_no=new JTextField(20);
		cust_name=new JTextField(20);
		cred=new JTextField(20);
		
		submit=new JButton("submit");
		display=new JButton("Display");
		
		area = new JTextArea();
		area.setSize( new Dimension(300, 300) );
		
		add(r);
		add(repno);
		add(r1);
		add(repname);
		add(r2);
		add(state);
		add(r3);
		add(comm);
		add(r4);
		add(rate);
		add(r5);
		add(cust_no);
		add(r6);
		add(cust_name);
		add(r7);
		add(cred);
		add(submit);
		add(display);
		add(area);
		submit.addActionListener(this);
		display.addActionListener(this);
		
		
		try {
			Class.forName("com.mysql.jdbc.Driver");
			
		} catch (ClassNotFoundException e1) {
			// TODO Auto-generated catch block
			e1.printStackTrace();
		}
		
		try {
			con=DriverManager.getConnection("jdbc:mysql://localhost:3306/Representative","root","");
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
	}
	
	public void actionPerformed(ActionEvent evt){
		if(evt.getSource()==submit){
			int repn=Integer.parseInt(repno.getText());
			String repna=repname.getText();
			String sta=state.getText();
			String com=comm.getText();
			String rat=rate.getText();
			int custn=Integer.parseInt(cust_no.getText());
			String custna=cust_name.getText();
			String cre=cred.getText();
			
			String query="insert into Rep values(?,?,?,?,?)";
			
			try {
				ps = con.prepareStatement(query);
				ps.setInt(1, repn);
				ps.setString(2, repna);
				ps.setString(3, sta);
				ps.setString(4, com);
				ps.setString(5, rat);
				int i=ps.executeUpdate();
				
			} catch (SQLException e) {
				// TODO Auto-generated catch block
				e.printStackTrace();
			}
			
			
			
			String query1="insert into Cust values(?,?,?,?,?)";
			
			try {
				ps1 = con.prepareStatement(query1);
				ps1.setInt(1, custn);
				ps1.setString(2, custna);
				ps1.setString(3, sta);
				ps1.setString(4, cre);
				ps1.setInt(5, repn);
				int i=ps1.executeUpdate();
				
			} catch (SQLException e1) {
				// TODO Auto-generated catch block
				e1.printStackTrace();
			}
			
			repno.setText("");
			repname.setText("");
			state.setText("");
			comm.setText("");
			rate.setText("");
			cust_no.setText("");
			cust_name.setText("");
			cred.setText("");
		}
		
		else{
			
			try {
				st=con.createStatement();
			} catch (SQLException e) {
				// TODO Auto-generated catch block
				e.printStackTrace();
			}
			
			try {
				rs=st.executeQuery("select * from Rep where repno in(select repno from Cust where cred>1500)" );
			}	catch (SQLException e) {
				// TODO Auto-generated catch block
				e.printStackTrace();
			}
			
			if(rs!=null){
				try {
					while(rs.next()){
						String repno = String.valueOf(rs.getInt(1));
						String repname = rs.getString(2);
						String state = rs.getString(3);
						String comm = rs.getString(4);
						String rate = rs.getString(5);
						area.setText(area.getText()+"\n"+ repno +"\t"+repname+"\t"+  state +"\t"+ comm +"\t"+ rate  );
						System.out.println(repno + repname + state + comm + rate);
					}
				} catch (SQLException e) {
					// TODO Auto-generated catch block
					e.printStackTrace();
				}
			}
		}
	}
	
	public static void main(String args[]){
		Representative obj=new Representative();
		obj.setVisible(true);
		obj.setSize(1000,800);
		obj.setLayout(new GridLayout(8,2));
	}
}